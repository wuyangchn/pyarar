#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @File   : pho_calculation.py
# @Author : Yang Wu
# @Date   : 2022/1/4
# @Email  : wuy@cug.edu.cn

"""
interpret the calculation of correlation coefficient of errors
"""
import numpy as np
from scipy import stats

# data from 19WHA014.age
a = [6.606234790982712, 11.546062198187876, 21.700781997042185, 30.40236081703037, 46.064634298652, 64.16286014491584, 95.70305914239958, 123.19509305932876, 147.8665387789021, 182.23001901902185, 176.1403693987587, 186.71676424734227, 185.43432892271437, 176.68435826740745, 169.08858418836226, 157.07974559719128, 150.35422046454502, 145.29098778428187, 160.85504172471127, 132.69971198868367, 117.51597552496537, 103.7698538956605, 97.46375591195458, 91.59172237548022, 82.86414053295269, 80.94321714099055, 75.78202900295237, 71.153038315329, 63.96344130047138, 60.45425315565684, 60.85238177621141, 56.717864622293945, 54.5580836217965, 50.28510369504354, 47.13955996802447, 46.19739694782906]
b = [3.3872641102007734, 2.8712246083133572, 2.8856057828398174, 5.407067540747388, 3.626097213149869, 3.677645423315714, 3.171761554252299, 4.660928221628459, 4.523760674449181, 5.917101279329984, 2.4812308053258314, 3.3462528234263322, 2.362599733977297, 2.3650251316681, 2.8070112735923565, 3.4435839430117077, 4.324244899456087, 3.0332152289701586, 2.383867633750081, 5.908748575466123, 2.79593617283684, 2.387968687446142, 5.525366281659281, 3.578219052283478, 5.155606441574357, 1.354885149884556, 4.051879312269744, 5.9007979973691125, 2.455051747104773, 2.7456009002580495, 2.494920768801782, 1.8539560573371108, 1.3866372971150034, 6.362496945531997, 4.790113074856688, 1.6827059789920835]
c = [86.9450253906512, 109.21595569496802, 121.262315229769, 92.35346641030739, 83.35623848248567, 78.1963372405265, 80.44738141794404, 75.35420251181692, 58.8833049081324, 57.74333153984109, 44.20612784425867, 44.052670739474856, 45.15257685589676, 43.08358827390422, 39.41731854706482, 34.060035496538404, 32.23238400893363, 28.491103830302336, 27.30793035679036, 22.412002336981402, 16.392695099152505, 14.659340628058365, 12.817795019491443, 11.271806734533447, 9.271474960220134, 8.841069322641374, 7.386311852667383, 6.684496150493885, 5.535390245043894, 5.093301663632568, 6.5903540554793665, 4.978649912024108, 4.74350774182088, 4.058308893803776, 3.9105239320686493, 4.066002910307137]
d = [1.2915707931167262, 2.6003059794807917, 1.223380007762781, 2.822172919779832, 2.062237751921027, 1.0840926658275085, 2.8995671741338653, 1.7137367198598528, 1.3001226054076445, 1.0132071373511615, 0.8858109143445732, 1.745788984862392, 1.3969592171608058, 2.176863219937291, 1.7826944753597407, 1.2443066468754302, 1.7419175784602916, 2.849566634173587, 1.7279453726350613, 1.800681817112771, 1.1412405913862307, 1.1814867857658988, 1.1525694879101431, 1.161024048708292, 1.7369147969722105, 0.26959156052900357, 0.489171519854113, 2.3261347575824756, 1.0722531646259876, 0.680827773641128, 1.026690278801472, 0.988219724061746, 0.9483958179937411, 2.6618379903610254, 1.0734531563997949, 1.026272452380318]
e = [26830.5097471, 33862.809307100004, 37892.1915871, 29303.5224471, 26866.4073471, 25465.6632271, 26596.0224485, 25402.5391085, 20403.6496385, 20341.7966785, 15951.9509185, 15979.0946485, 16312.373698799998, 15549.0998988, 14376.078378799999, 12530.9449888, 11836.1095788, 10522.6874288, 10325.07867477, 8441.810795770001, 6334.09844277, 5588.60506577, 4932.84540777, 4416.51200877, 3687.8792380299997, 3479.07887803, 2991.8076320299997, 2747.0720160299998, 2240.28332503, 2100.50485303, 2497.85552333, 2028.0351473299997, 1917.6178773299998, 1640.6802323299999, 1572.34615833, 1594.2900693299998]
f = [40.93407706773807, 4.86895225746259, 177.46014070966302, 14.986247598238691, 30.717221319370427, 76.50357629833444, 91.74732071547412, 82.61786215903669, 14.426610657925613, 32.71216530894342, 42.37060905781187, 62.51880275983352, 24.312218219944334, 34.75159983763232, 60.65885705448291, 16.92620922037219, 47.53839606049166, 21.12837552166176, 24.13054510318878, 31.70782701879834, 18.464624186949674, 16.47921532043359, 30.363302134740515, 11.105419345837566, 4.748902486770548, 19.943113403996456, 22.316036854978623, 5.478218971697163, 13.939649546037211, 8.906688065058958, 10.483539304337365, 6.284000377595017, 7.961423313877344, 6.150996470935795, 3.422010405287142, 12.5221240974513]
g = [0.06764784425966297, 0.11823167690944386, 0.222216007649712, 0.311320174766391, 0.4717018552181965, 0.6570276878839383, 0.9799993256181718, 1.2615177529275265, 1.5141533570959578, 1.8660353947547839, 1.8036773826432893, 1.911979665892785, 1.8988475281685953, 1.8092478286582525, 1.7314671020888297, 1.6084965949152388, 1.5396272175569412, 1.4877797149110465, 1.6471556272610435, 1.358845050764121, 1.2033635893756456, 1.0626033038915637, 0.998028860538415, 0.9378992371249175, 0.8485287990574356, 0.8288585435237433, 0.7760079769902324, 0.728607112348969, 0.654985638916827, 0.6190515523139262, 0.6231283893884049, 0.5807909337322901, 0.5586747762871962, 0.5149194618372459, 0.4827090940725706, 0.47306134474576966]
h = [0.03468558448845593, 0.029401339989128777, 0.02954860321627973, 0.055368371617253255, 0.03713123546265466, 0.03765908913475292, 0.032478838315543546, 0.04772790498947543, 0.04632330930635962, 0.060591117100339036, 0.025407803446536516, 0.03426562891188564, 0.024193021275927522, 0.024217857348281347, 0.028743795441585732, 0.035262299576439886, 0.04428026777043033, 0.031060123944654426, 0.02441080456960083, 0.06050558541277311, 0.028630386409849246, 0.024452799359448496, 0.05657975072419104, 0.03664096309538282, 0.052793409961721424, 0.013874023934817854, 0.04149124415764218, 0.06042417149305972, 0.025139729890352874, 0.02811495321864243, 0.025547988672530247, 0.018984510027132015, 0.014199165922457636, 0.06515196872224766, 0.04905075788653249, 0.017230909224878938]
pho = [0.169315695145469, 0.299509541025731, 0.229764416357509, 0.732764268932424, 0.510009015104875, 0.584917400890134,
       0.473430080880095, 0.810985472851643, 0.906751329592566, 0.923591451476752, 0.965708968921516, 0.934696108394293]

points = [i for i in range(3, 15)]
Ar39K = [a[i] for i in points]
sAr39K = [b[i] for i in points]
Ar36air = [c[i] for i in points]
sAr36air = [d[i] for i in points]
Ar40 = [e[i] for i in points]
sAr40 = [f[i] for i in points]
Ar40K = [g[i] for i in points]
sAr40K = [h[i] for i in points]
Ar40ar = [Ar40[i] - Ar40K[i] for i in range(len(Ar40))]
sAr40ar = [(sAr40[i] ** 2 + sAr40K[i] ** 2) ** 0.5 for i in range(len(Ar40))]

def get_cov(a0: list, a1: list):
    return sum([(a0[i] - sum(a0) / len(a0)) * (a1[i] - sum(a1) / len(a1)) for i in range(len(a0))]) / len(a0)


phos = [[], []]
for i in range(100):
    random_Ar39K = np.random.normal(Ar39K[0], sAr39K[0], 50)
    random_Ar40ar = np.random.normal(Ar40ar[0], sAr40ar[0], 50)
    random_Ar36air = np.random.normal(Ar36air[0], sAr36air[0], 50)

    random_x = [i / j for i in random_Ar39K for j in random_Ar36air]
    random_y = [i / j for i in random_Ar40ar for j in random_Ar36air]

    cov = get_cov(random_x, random_y)
    pho_xy = cov / (np.nanstd(random_x) * np.nanstd(random_y))
    pho_Ar39K_Ar40ar = get_cov(random_Ar39K, random_Ar40ar) / (np.nanstd(random_Ar39K) * np.nanstd(random_Ar40ar))
    print("{}, {}".format(pho_xy, pho_Ar39K_Ar40ar))
    phos[0].append(pho_xy)
    phos[1].append(pho_Ar39K_Ar40ar)
print(np.nanmean(phos[0]))
print(np.nanmean(phos[1]))
